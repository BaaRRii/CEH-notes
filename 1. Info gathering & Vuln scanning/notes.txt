Active reconnaissance is a method of information gathering in which the tools used actually send out probes to the target network or systems in order to elicit responses that are then used to determine the posture of the network or system. These probes can use various protocols and multiple levels of aggressiveness, typically based on what is being scanned and when. For example, you might be scanning a device such as a printer that does not have a very robust TCP/IP stack or network hardware. By sending active probes, you might crash such a device. Most modern devices do not have this problem; however, it is possible, so when doing active scanning, you should be conscious of this and adjust your scanner settings accordingly.

Passive reconnaissance is a method of information gathering in which the tools do not interact directly with the target device or network. There are multiple methods of passive reconnaissance. Some involve using third-party databases to gather information. Others also use tools in such a way that they will not be detected by the target. These tools, in particular, work by simply listening to the traffic on the network and using intelligence to deduce information about the device communication on the network. This approach is much less invasive on a network, and it is highly unlikely for this type of reconnaissance to crash a system such as a printer. Because it does not produce any traffic, it is also unlikely to be detected and does not raise any flags on the network that it is surveying. Another scenario in which a passive scanner would come in handy would be for a penetration tester who needs to perform analysis on a production network that cannot be disrupted. The passive reconnaissance technique that you use depends on the type of information that you wish to obtain. One of the most important aspects of learning about penetration testing is developing a good methodology that will help you select the appropriate tools and technologies to use during the engagement.

Common active reconnaissance tools and methods include the following:

- Host enumeration
- Network enumeration
- User enumeration
- Group enumeration
- Network share enumeration
- Web page enumeration
- Application enumeration
- Service enumeration
- Packet crafting

Common passive reconnaissance tools and methods include the following:
- Domain enumeration
- Packet inspection
- Open-source intelligence (OSINT)
- Recon-ng
- Eavesdropping

PASSIVE

Tools:
- recon-ng
- spiderfoot
- dnsrecon
- whois
- nslookup

Cryptographic flaws
- During the reconnaissance phase, attackers often can inspect Secure Sockets Layer (SSL) certificates to obtain information about the organization, potential cryptographic flaws, and weak implementations. You can find a lot inside digital certificates: the certificate serial number, the subject common name, the uniform resource identifier (URI) of the server it was assigned to, the organization name, Online Certificate Status Protocol (OCSP) information, the certificate revocation list (CRL) URI, and so on.
- Tools such as crt.sh enable you to obtain detailed certificate transparency information about any given domain. Figure 3-2 shows the result of the query https://crt.sh/?q=h4cker.org in crt.sh for the domain h4cker.org. You can see in the search results multiple subdomains that were not known to the attacker before.

Tools:
- sslscan Queries SSL services to determine what cyphers are supported
- ssldump Analyze and decode SSL traffic
- sslh Running multiple services on port 443
- sslsplit Enable MitM attacks on SSL encrypted network connections
- sslyze Analyze the SSL configuration of a server by connecting to it

Password dumps

Tools:
- h8mail
- WhatBreach: https://github.com/Ekultek/WhatBreach
- LeakLooker: https://github.com/woj-ciech/LeakLooker
- Buster: https://github.com/sham00n/buster
- Scavenger: https://github.com/rndinfosecguy/Scavenger
- PwnDB: https://github.com/davidtavarez/pwndb

File Metadata

Tools:
- ExifTool

Google Dorks:

Tools:
- http://exploit-db.com/google-hacking-database

Email breaches

Tools:
- haveibeenpwned.com
- f-secure.com
- hacknotice.com
- breachdirectory.com
- keepersecurity.com

Emails of a domain

Tools:
- emailharvester
- spiderfoot

Shodan has a CLI implementation

ACTIVE

Nmap Port Status Reported	Response from Target	Nmap Analysis
Open	TCP SYN-ACK	The service is listening on the port.
Closed	TCP RST	The service is not listening on the port.
Filtered	No response from target or ICMP destination unreachable	The port is firewalled.

Nmap scan types
- TCP Connect Scan (-sT)
- UDP Scan (-sU)
- TCP FIN Scan (-sF)
- Host Discovery Scan (-sn)

Timing options
- T0 (Paranoid) : Very slow, used for IDS evasion
- T1 (Sneaky) : Quite slow, used for IDS evasion
- T2 (Polite) : Slows down to consume less bandwidth, runs about 10 times slower than the default
- T3 (Normal) : Default, a dynamic timing model based on target responsiveness
- T4 (Aggressive) : Assumes a fast and reliable network and may overwhelm targets
- T5 (Insane) : Very aggressive; will likely overwhelm targets or miss open ports

Types of enumeration
- Host Enumeration
- User Enumeration
- Group Enumeration
- Network Share Enumeration
- Additional SMB Enumeration Examples
- Web Page Enumeration/Web Application Enumeration
- Service Enumeration
- Exploring Enumeration via Packet Crafting

Scapy can also be used to enumerate via Packet Crafting

Packet Inspection and Eavesdropping

Tools:
- wireshark
- tcpdump
- tshark

How a Typical Automated Vulnerability Scanner Works
- Step 1. In the discovery phase, the scanner uses a tool such as Nmap to perform host and port enumeration. Using the results of the host and port enumeration, the scanner begins to probe open ports for more information.
- Step 2. When the scanner has enough information about the open port to determine what software and version are running on that port, it records that information in a database for further analysis. The scanner can use various methods to make this determination, including using banner information.
- Step 3. The scanner tries to determine if the software that is listening on the target system is susceptible to any known vulnerabilities. It does this by correlating a database of known vulnerabilities against the information recorded in the database about the target services.
- Step 4. The scanner produces a report on what it suspects could be vulnerable. Keep in mind that these results are often false positives and need to be validated. At the very least, this type of tool gives you an idea of where to look for vulnerabilities that might be exploitable.

Types of Vulnerability Scans
- Unauthenticated Scans
- Authenticated Scans
- Discovery Scans
- Full Scans
- Stealth Scans
- Compliance Scans

sudo nmap -sV --script vulners --script-args mincvss=4.0 10.6.6.23
sudo gvm-start
sudo gvm-check-setup

Helpful sources for further investigation of vulnerabilities
- US-Cert
- NIST
- JPCERT
- CAPEC
- CAPEC
- CVE
- CWE 
- CVSS

How to prioritize findings:
- What is the severity of the vulnerability?
- How many systems does the vulnerability apply to?
- How was the vulnerability detected?
- Was the vulnerability found with an automated scanner or manually?
- What is the value of the device on which the vulnerability was found?
- Is this device critical to your business or infrastructure?
- What is the attack vector, and does it apply to your environment?
- Is there a possible workaround or mitigation available?
